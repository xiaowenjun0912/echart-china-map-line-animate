<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ECharts</title>
  <!-- å¼•å…¥ echarts.js -->
  <script src="echarts.min.js"></script>
<!--  <script src="echarts-gl.min.js"></script>-->
  <script src="china.js"></script>
  <script src="bmap.min.js"></script>
</head>
<body onclick="setTimeout(oneByOne(1), 100000)">
<!-- ä¸ºEChartså‡†å¤‡ä¸€ä¸ªå…·å¤‡å¤§å°ï¼ˆå®½é«˜ï¼‰çš„Dom -->
<div id="main" style="width: 880px;height:470px;"></div>
<script type="text/javascript">
  // åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹
  var myChart = echarts.init(document.getElementById('main'));

  // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®
  var chinaGeoCoordMap = {
    'é»‘é¾™æ±Ÿ': [127.9688, 45.368],
    'å†…è’™å¤': [110.3467, 41.4899],
    "å‰æ—": [125.8154, 44.2584],
    'åŒ—äº¬å¸‚': [116.4551, 40.2539],
    "è¾½å®": [123.1238, 42.1216],
    "æ²³åŒ—": [114.4995, 38.1006],
    "å¤©æ´¥": [117.4219, 39.4189],
    "å±±è¥¿": [112.3352, 37.9413],
    "é™•è¥¿": [109.1162, 34.2004],
    "ç”˜è‚ƒ": [103.5901, 36.3043],
    "å®å¤": [106.3586, 38.1775],
    "é’æµ·": [101.4038, 36.8207],
    "æ–°ç–†": [87.9236, 43.5883],
    "è¥¿è—": [91.11, 29.97],
    "å››å·": [103.9526, 30.7617],
    "é‡åº†": [108.384366, 30.439702],
    "å±±ä¸œ": [117.1582, 36.8701],
    "æ²³å—": [113.4668, 34.6234],
    "æ±Ÿè‹": [118.8062, 31.9208],
    "å®‰å¾½": [117.29, 32.0581],
    "æ¹–åŒ—": [114.3896, 30.6628],
    "æµ™æ±Ÿ": [119.5313, 29.8773],
    "ç¦å»º": [119.4543, 25.9222],
    "æ±Ÿè¥¿": [116.0046, 28.6633],
    "æ¹–å—": [113.0823, 28.2568],
    "è´µå·": [106.6992, 26.7682],
    "äº‘å—": [102.9199, 25.4663],
    "å¹¿ä¸œ": [113.12244, 23.009505],
    "å¹¿è¥¿": [108.479, 23.1152],
    "æµ·å—": [110.3893, 19.8516],
    'ä¸Šæµ·': [121.4648, 31.2891]
  };
  var chinaDatas = [
    [{
      name: 'é»‘é¾™æ±Ÿ',
      value: 0,
      price: 100,
      num: 2
    }],
    [{
      name: 'å†…è’™å¤',
      value: 0,
      price: 100,
      num: 2
    }],
	[{
        name: 'è¥¿è—',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'å››å·',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'é‡åº†',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'å±±ä¸œ',
        value: 0,
        price: 100,
        num: 2
    }],
	 [{
        name: 'æ±Ÿè¥¿',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'æ¹–å—',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'è´µå·',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'å¹¿è¥¿',
        value: 0,
        price: 100,
        num: 2
    }],
    [{
        name: 'æµ·å—',
        value: 0,
        price: 100,
        num: 2
    }],
  ];
  var convertData = function(data) {
    var res = [];

    var fromCoord = chinaGeoCoordMap[data[0][0].name];
    var toCoord = fromCoord;
    for (var i = 0; i < data.length; i++) {
      var dataItem = data[i];
      // 			console.log('dataItem',dataItem) //ç¬¬äºŒä¸ªæ•°æ®
      // var fromCoord = [116.4551, 40.2539];
      toCoord = chinaGeoCoordMap[dataItem[0].name];
      // 			console.log('toCoord',toCoord);//ç¬¬ä¸€ä¸ªåœ°å€
      if (fromCoord && toCoord) {
        res.push([{
          coord: fromCoord,
          value: dataItem[0].value,
        }, {
          coord: toCoord,
          dataItem: dataItem
        }]);
      }
      fromCoord = toCoord;
      console.log(fromCoord,'æ‰“å°å‡ºæ¥æ˜¯ä¸€ä¸ªfromCoord2222')

    }
    console.log("res =" + res)
    return res;
  };
  let redName = 'æ–°ç–†';
  var planePath = 'path://M.6,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705';

  var series = [];
  [
    ['åŒ—äº¬å¸‚', chinaDatas]
  ].forEach(function(item, i) {
    console.log('å¾—åˆ°æ•°æ®', item)
    series.push({
        type: 'lines',
        zlevel: 2,
        effect: {
          // æ‹¬ 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow', 'none'
          show: true,
          period: 1, //ç®­å¤´æŒ‡å‘é€Ÿåº¦ï¼Œå€¼è¶Šå°é€Ÿåº¦è¶Šå¿«
          trailLength: 0.3, //ç‰¹æ•ˆå°¾è¿¹é•¿åº¦[0,1]å€¼è¶Šå¤§ï¼Œå°¾è¿¹è¶Šé•¿é‡
          symbol: 'circle', //ç®­å¤´å›¾æ ‡
          symbolSize: 3, //å›¾æ ‡å¤§å°
          color: "#fff"
        },

        lineStyle: {
          normal: {
            width: .9, //å°¾è¿¹çº¿æ¡å®½åº¦
            opacity: .5, //å°¾è¿¹çº¿æ¡é€æ˜åº¦
            curveness: 0.2, //å°¾è¿¹çº¿æ¡æ›²ç›´åº¦
            color: function(params) { //åœ†ç¯æ˜¾ç¤ºæ–‡å­—
              // console.log('redName',redName)

              return '#ffa022'

            },
          },
          color: 'red'
        },
		tooltip: {
                //  show:false,
                trigger: 'item',
                backgroundColor: 'rgba(8, 18, 42, 0.85)',
                borderColor: '#040616',
                showDelay: 0,
                hideDelay: 0,
                enterable: true,
                transitionDuration: 0,
                extraCssText: 'z-index:100',
                formatter: function(params, ticket, callback) {
                    //æ ¹æ®ä¸šåŠ¡è‡ªå·±æ‹“å±•è¦æ˜¾ç¤ºçš„å†…å®¹
                    //console.log('params--1',params)
                    let res = "";
  					let name = "åŒ—äº¬-è¥¿å®64S0003IPBB/Î»"
                    res = "<div style='color:#fff;'><span>ç”µè·¯ï¼š" + name + "</span><br/></div>";
                    let html = '<div class="mapTableContent"><div class="tableTop">åŒ—äº¬ -> æ–°ç–†</div> <div class="tableList"> <div class="item itemTop"> <p>åŸå¸‚</p> <p>å‡ä»·</p> <p>çº¿è·¯æ•°</p> </div> <div class="item"> <p>æ–°ç–†-1</p> <p>100</p> <p>1</p> </div> <div class="item"> <p>æ–°ç–†-2</p> <p>200</p> <p>2</p> </div> </div> </div>' 
                    if(name == redName){
                        return html;
                    }else{
                        return res;
                    }
                }
            },
        data: []
        // data: convertData(item[1])
      }, {
        type: 'effectScatter',
        coordinateSystem: 'geo',
        zlevel: 2,
        rippleEffect: { //æ¶Ÿæ¼ªç‰¹æ•ˆ
          period: 10, //åŠ¨ç”»æ—¶é—´ï¼Œå€¼è¶Šå°é€Ÿåº¦è¶Šå¿«
          brushType: 'fill', //æ³¢çº¹ç»˜åˆ¶æ–¹å¼ stroke, fill
          scale: 2.2 //æ³¢çº¹åœ†ç¯æœ€å¤§é™åˆ¶ï¼Œå€¼è¶Šå¤§æ³¢çº¹è¶Šå¤§
        },
        symbol: 'circle',
        symbolSize: function(val) {
          return 5; //åœ†ç¯å¤§å°
        },
        itemStyle: {
          normal: {
            show: false,
            color: function(params) { //åœ†ç¯æ˜¾ç¤ºæ–‡å­—
              return '#ffa022'

            },
            borderWidth: 0,
            shadowColor: '#b5e8fa', //å‘å…‰ğŸ‰æ•ˆæœ
            shadowBlur: 4
          }
        },
        data: item[1].map(function(dataItem) {
          return {
            dataItem: dataItem,
            name: dataItem[0].name,
            value: chinaGeoCoordMap[dataItem[0].name].concat([dataItem[0].value])
          };
        }),
      },

    );
  });

  option = {
    tooltip: {
      //  show:false,
      trigger: 'item',
      backgroundColor: 'rgba(166, 200, 76, 0.82)',
      borderColor: '#040616',
      showDelay: 10,
      hideDelay: 0,
      enterable: true,
      transitionDuration: 0,
      extraCssText: 'z-index:100'
    },
    // backgroundColor: "#001339",
    backgroundColor: '#001d3d',
    // visualMap: { //å›¾ä¾‹å€¼æ§åˆ¶
    //     min: 0,
    //     max: 1,
    //     calculable: true,
    //     show: false,
    //     color: ['#4fc6ef', '#4fc6ef', '#4fc6ef', '#4fc6ef', '#4fc6ef'],
    //     textStyle: {
    //         color: '#fff'
    //     }
    // },
	
    geo: {
      map: 'china',
      zoom: !1,
      label: {
        emphasis: {
          show: true
        },
		normal: {
                show: !0,
                fontSize: "10",
                color: "#ffd768"
        }
      },
      //roam: false, //æ˜¯å¦å…è®¸ç¼©æ”¾
      itemStyle: {
        normal: {
          color: "#092765", //åœ°å›¾èƒŒæ™¯è‰²
          borderColor: '#6481a0', //çœå¸‚è¾¹ç•Œçº¿00fcff 516a89
          borderWidth: 1
        },
        emphasis: {
          color: 'rgba(37, 43, 61, .5)' //æ‚¬æµ®èƒŒæ™¯
        }
        //   normal: {
        //     areaColor: '#132937',
        //     borderColor: '#0692a4'
        // },
        // emphasis: {
        //     areaColor: '#0b1c2d'
        // }
      }
    },
	
    series: series
  };

  // ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚
  myChart.setOption(option);

  var oneByOne = function (data) {
    var tempdata = []
    for(var i = 0;i < data;i++){
      tempdata.push(chinaDatas[i])
    }
    console.log(tempdata)
    myChart.setOption({
        series:[{
          data:convertData(tempdata)
        }]
      }
    );
    if(data<chinaDatas.length){
      setTimeout(function () {oneByOne(data + 1)}, 500)
    }
  }
 // setTimeout(oneByOne(1), 100000)

</script>
</body>
</html>
